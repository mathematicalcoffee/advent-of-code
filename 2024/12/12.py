from collections import Counter
import numpy as np
import skimage.measure

ex1 = """
AAAA
BBCD
BBCC
EEEC
"""

ex2 = """
OOOOO
OXOXO
OOOOO
OXOXO
OOOOO
"""

ex3 = """
RRRRIICCFF
RRRRIICCCF
VVRRRCCFFF
VVRCCCJFFF
VVVVCJJCFE
VVIVCCJJEE
VVIIICJJEE
MIIIIIJJEE
MIIISIJEEE
MMMISSJEEE
"""

ex4="""
EEEEE
EXXXX
EEEEE
EXXXX
EEEEE
"""

ex5="""
AAAAAA
AAABBA
AAABBA
ABBAAA
ABBAAA
AAAAAA
"""

input = """
WWWJJJJJJJJJJJJJJJSFFFFFFFFFFKKKHHHHHHHHHHHHHHHHHHHHHOOUEEEEEEEEEEEEEEEFGPPPQQQQQQQQQQQQQQSSSJJJJJJJJJJJJJJIIGGGGQQQQQQQQQQQQQQQQUUUUUUUUUUU
WWWJJJJJJJJJJJJJJJJJFFFFFFFFFFKKHHHHHHHHHHHHHHHHHHHHHOOUUEEEEEEEEEEEEFFFGPPPPPPQQQQQQQQQQQQSJJJJJJJJJJJJJJJIIGGGGGGQQOQQQQQQCCCQUUCCUUUUUUUU
WWWWJJJJJJJJJJJJJJOJFFFFFFFFFKKKHHHHHHHHRHHHHHHHHHHHHUUUUEEEEEEEEEEEFWFFFQQPMMPLLPQQQQQQQQJJJJJJJJJJJJJJJJJGIGGGGQQQOOOOOQCCCCCQCCCUUUUUUUUU
WWWWWJJJJJJJJJJJJJOJJFFFFFFFFFKKHGHHHHHRRHHHHHHHHHHHUUUUUEEEEEEEEEEEFWFFFFQPMPPPLPQQQQQQQQCJJJJJJJJJJJJJJJJJJJGGQQQQQOOOOQOQCCCCCCCCCGGGUUUU
WWWJJJJJJJJJJJJJJJJJFFFFFFFFFFKKKHHHHHRRRRRRHHHHHHHHUUUUUMEEEEEEEEEFFFFFFFFPPPPPPPPPQQQQQQBBJJJJJJJJJJJJJJJJJJGGGGQQOOOOOQOQCCCCCCCCIGGGUUUU
WOJJJJJJJJJJJJJKJKKFFFFFFFFKFKKKKHHHHRRRRRRMRRHHHHHHHHUUUMMMMEEEEEFDFFFFFFFPPPPPPPJPQQQQQQBBBJJJJJJJJJJJJJJJJJGGGQQQOOOOOOOOUCCCCCCCCCPGUUGU
OOJJJQJJJJJJJJJKKKKKKFFFFFFKKKKKKHHHRRRRRRRRRRHHHHHKKHUUUMMMMMEEEEFFFFFFFFFPPPPPPPPPQQQQJQBBJJJJJJJJJJJJJJJJJJGGGGGOOOOOOOOCCCCCCCCCCCCGGGGU
POOJJQOJJJSSSJJKKKKKKFFFFFFKKKKKHHHBBRRRRRRRRRZHHHHHKMMUMMMMMMEMEEFFFFFFFFYPPPPPPPPPQQQJJBBBJJJJJJJJJJJJJJJJJJGGGGGOOOOOOOOCCCCCCCCCCCCCGGGG
OOOOOOOOOJSSSSJKKKKKKKKKFKKKKKKDDDDBBBBRRRRRZZZHZHHZMMMMMMMMMMMMEEEPFFFFFFYPPPPPPPPPPQQJJJBJJJJJJJJJJJJJJJJJJJGGGGOOWOOOOOOCCCCCCCCCCCCCGGGG
OOOOOOOOOOGGSJJJKKKKKKKKFKKKKKKKKDDDDDDDWRRRRZZZZHZZMMMMMMMMMMEEEEEPFFFFFFYPPPPPPPPFPQQQJJJJJJJJJJJJJJJJJJGGGGGGGGGGGOOOOOCCCCCCCCCCCSGGGGGG
OOOOOOOOOGGGSJJKKKKTKKKKKKKKKKKKKKDDDDDDWRRRRZZZZZZZZMMMMMMMMMMMEPPPPFFFFFYYYPPPPPPPQQQQTJJJJJJJJJJJJJJJJJGGGGGGGGGGGOOOOOOCCCCCCCCCRGGGGGGG
OOOOOOOOOGGGGYTTKKTTKKKKKKKKKKKKKKDDDDDWWWRRRZZZZZZZZZMMMMMMMMMPPPPPPPFFYFYGYPPPPPPGGQQQTTTJJJJJJJJJJJJJJJGGGGGGGGGGGGGGGOCCCCCCCCCCRRGGGGGG
TOOOOOOOGGGGGYTTTTTTKKKKKKKKKKDDDDDDDDDDWWRRZZZZZZZZZMMSMMMMMMHHPPPPPPFFYYYGGGGGPGGGGQQQTTTTTTJJJJJJJJJJJJGGGGGGGGGGGGGGOOGCCCCCCCRRRRGGGGGG
OOOOOOOGGGGGGYYTYTTTKKKKKKKKKKKDDDDDDDDDDRRZZZZZZZZZZMMSMSMMMMMHPPPPPPPPPPYYGGGGPGGGQQQTTTTTTTTJJJJJJJJJJJGLGGGGGGGGGGGGGGGCCCCCXXXXRRRRGGGG
OOOOOGGGGGGGGYYYYYTTTTTTKKKKKKKKDDDDDDDDRRZZZZZZZZZZZMMSMSSMMIPPPPPPPPPPPYYYYGGGGGGGQQTTTTTTRTJJJJJJJJJJJJGLLVGGGGGGGGGGGGGCGGCSXXXXXRRGGGGR
SOGGGGGGGGGGMMMMMMMTTTTTVVVVKKKDDDDDDDDDDDZZZZZZZZZZZMCSSSSSMMPPPPPPPPPPPPPYGGGGGGGGKKMTQQRRRRRRRJJJJJJJJJLLLLGGGGGGGGGGGGGGGGGGGXXXXRRRRGGR
SOSGGGGGGGGGMMMMMMMMMMMMMMVVKKVVXDDDDDDDDDZZZZZZZZZZSSSSSSSSMPPPPPPPPPPPPPPYYGGGGGGKKKKQQRRRRRRRRRRRLLLLLLLLLLGGGGGGGGGGGGGGGGGXXXXXXXRRRGRR
SSSSSGGGGGGGMMMMMMMMMMMMMMVVVVVXXDDDDDDDDZZZZZZZZZZZZSSSSSSSYPPPPPPPPPPPPYYYYGGKKKKKKKKKKKRRRRRRRRRLLLLLLLLLLGGGGGGGGGGGGGGGGGXXXXXXLXXRRGRR
SSSSSGGGGGGGMMMMMMMMMMMMMMVVVVVXXXDDXXDZZZZZZZZZZZZZZSSSSSSSSSZPPPPPPPPPPPPKKKKKKKKKKKKKYYYRRRRRRRRRRLLLLLLLLLLLGGGGGGGGGGGVGGZXXXXXXXRRRRRR
SSSSSGGGGGGGMMMMMMMMMMMMMMVVVVVVXXXXXXXZZZZZZZZZZZZZZSSSSSSSSZZZPPPPPPPPPPRKKKKKKKKKKKKKKYYRRYRRRRRRRLLLLLLLLLLLGGGGGGGGGPGVGZZZXXXXXRRRRQRR
SSSSSGGMMMMMMMMMMMMMMMMMMMVVVVVVXXXXXXXZZZZZZZZZZZZZZSZZSSSZZZPPPFFFFFFFPPRKKKKKKKKKKKKKYYYYRYRRRRRLRRLLLLLLLAALGGGGGGGGGGGVVVZZXXRRRRRQQQRR
SSSQSSGMMMMMMMMMMMMMMMMMMMVVVVVVXXXXXXZZZZZZZZZZZZZZZZZZZZZZZZZZPFFFFFFFPKRKKKKKKKKKKKRRRRRYRLLCRRLLRRRRRRLLAAGGGAGGGGGGGVGGVVVCCCCCRRRQQQQQ
FSSGGGGMMMMMMMMMMMMMMMMMMMVVVVVXXXXXXXZZZZZZZXXZZZKZZZZZZZZZZZZZZFFFFFFFPKKKKKKKKKKKKKRRRRRRGLLLJLLRRLRRRRRRRAAAGAGAGGUVVVVVVVCCCCCXRQQQQQFF
FGMMMMMMMMMMMMMMMMMMMMMMMMVQQVVXXXEXXXZXZXZXXXXZZZZZZZZZZZZZZZZZZZZFPPPXXKKGKKKKKKKKKIRRRRRRGLLLLLLLLLRRRRREAAAAAAAAAAUUVVVVAAOCCFFRRFQQFFFF
GGMMMMMMMBBBKMMMMMMMMTTTTTVTTCVVXEEEXXXXZXXXXXXXXXWWWWWWWWWZZZZZZFFFFFQQQQQGKKKKKKKKKIRRRRRRLLLLLLLLLLRRRRREAAAAAAAAAAAUUJJJAAAAAAAJRQQFFFFF
DDMMMMMMMBBBBMMMMMMMMBBTTTTTTCVVXEEEEXXXZZXXXXXXXXWWWWWWWWWZZZZZZFFFFFQQQQQKKKKKKKKKWRRRRRRRLLLLLLLLLRRRRRREEAAAAAYYYAUUUJJAAAAAAAAJRFFFFFFF
DDMMMMMMMBBBBMMMMMMMMBBTTTTTTTVVXEEEXXXXXZZXXXXXXZWWWWWWWWWNZZZZZZFFFFQQQQQKKKKKKKKWWWRRRRRLLLLLLLLLLLREERREEAAAAAYYYUUUUUUUAAAAAJJXXFFFFFFF
DDMMMMMMMBBBBBBBBBBBBBBBTTTTTTUVEEEEEEEEXXXXXXXMMZWWWWWWWWWNNZZZZZFFFFQQQQQQQQQQQQQWRRRRRRRRRSLLLLLLLLREEEREEAVVVVYYYYYUAUAAAAAXWXXXXXXFFFFF
DDMMMMMMMBBBBBBBBBBBBBBBTTTUUUUVEEEENEEXXXXXXXMMMMWWWWWWWWWNZZZZFFFFFFQQQQQQQQQQQQQDDSSSRRRRRSLLLLLLLLLLEEEEEAAVYYYYYYYUAAAAAAAXXXXXXXXFFFFF
DDMMMMMMMRBBBBBBBBBBBBBBTUUUUUEEEEEEEEEXXXXXXXMMMMWWWWWWWWWNEEZEEEBFFFQQQQQQQQQQQQQQQQQSSSRSSSLLLLLLLLLEEEEEEAYYYYYYYYYUAAAAAAXXXXXXXXXFFFFF
DDMMMMMMMUBBBBBBBBBBBUBUUUUUUIEEEEEEEEEEXXXMMXMMMMWWWWWWWWWEEEZEEEBBFFQQQQQQQQQQQQQQQQQSSSRSSSLLLLLLLLLEEEEEEEYYYYYYYYYYYYYYYXXXXXXXXXXXFFFF
DSMMMMMMMUUUJBBBBBBBBUUUUUUUIIIEEEEEEEEEEEEMMMMMMMWWWWWWWWWWWWWWWWBBBFQQQQQQQQQQQQQQQQQSSSSSSSLLLLLTLLLEEEEEEEYYYYYYYYYYYYYYYXXXXXXXXXXXXFXX
SSSWSSSUUUUUUBBBBUUUUUUUUUUIIIEEEEEEEEEEEEMMMMMMMMMMMMMZNWWWWWWWWWEBEBQQQQQIYQQQQQQQQQQSSSSSSSSBLLLLEEEEEEEEEEYYYYYYYYYYYYYYYXXXXXXXXXXXXXXX
SSWWSSRUUUUUBBUUUUUUUUUUUUUUUIEEEEEEEEEEEEMMMMMMMMMMMMZZZWWWWWWWWWEEEBQQQQQQYQQQQQQQQQQSSSSSSSSSSSLEEEEEEEEEEEYYYYYYYYYYAAAAAAXXXXXXXXXXXXXX
WWWWSTRUUUUUYBUEEEEEUEUUUUULUUEEEEEEEEEEOEMMMMMMMMMMMMZZZWWWWWWWWWEIIIIITQQQYQQQQQQQQQQSSSSSSSSSSSSEEEEEEEEEEEYYYYYYYYYYIAAAAAAAXXXXXXXXXXXX
WWWWWTTTUTUUUBUEEEEEEEUUUUULLUEEEEEEEEEOOMMMMMMMMMMMZZZZZWWWWWWWWWEMIJJIIQQQLQQQQQQQQQQSSSSSSSSSSSEEEEEEEEEEEEYYYYYYYYYYIAAAAAAXXXXXXXXXXXXX
WWWTWTTTTTUUUUUUUEEEEEUULLLLLEEEEEEJIIIIIMMMMMMMMMMZZZZZZWWWWWWWWWEMIJJIIQQQLLLLLLDUUUSSSSSSSSSSSEEEEEEEEEEEEEYYYYYYYVIIIAAAAAAXXXXXXXXXXXXX
WWWTTTTTTTTTUUUUUEEEEEEENEELEEEEEEEEEEIIIIMMMMMMMMZZZZZZZWWWWWWWWWEEIIIIIILLLLLLLUUUUSSSPPSSSSSSSEEEEEEEEEEEVEYYYYYYYVVVIIAAAAAAYXXXXXXXXXXX
WWWWTTTTTTTUUUUUUUUEEEEEEEEEEEEEEEEEEIIIIMMMMMMMMZZZZZZZZWWWWWWWWWEEIIIIIIILLLLLLUUUUSSSPPSSSSSSEEEEEEEEEEEEVVYYYYYYYVVFFIAAAAAYYXYYYYXXXXXT
WTTTTTTTNTTUTUUUUUEEEEEEEEEQQQEEEEEEEIIIIMMMMMMMMQZWZZZZZWWWWWWWWWEEEIIIIIIIILLUUUUUUPPPPPPSSSSSSBTEEEEEEEEEVVVVVVVVVVXXAAAALLLZYYYYYYXXTTTT
TTTTTTTTTTTTTUUUUUEEEEEEEEEQQEEQEEEEEEIIIMMMMMMMMQZZZZZUZWWWWWEEEEEEEIIIIIIIIIUUUUUUPPPPPPPPSSSSPBBEBBBBEEEEEVVVVVXXXXXXRRAALLZZZYYYYYXXXTTT
TTTTTTTTTTTTTUUUUUEEEEEEEEEQQQFQQEEEEIIIIIMMMNNFFFFZMZFFFFFFEEEEEEEEEIIIIIIIIUUUUUFPPPPPPPPSXXSSBBBBBBBBEEEEVVVVVXXXXXXXXAAALYYYYYYYYYYXXTTT
TTTTTTTTRRRTTUUUUUEEEEEEEEQQFFFQQQQIIIIIIIIIMNNNFFFZMFFFFFFFFFFFEEEEEEIIIIIUUUUUUFFFFFPPPPSSSSSSBBBBBBBBRRVEVVVVVXXXXXXXXXLLLYYYYYYYYYTXXTTT
TTTTTTTTRRRRRIUUUEEEEEEEEEEEFFFFQFQQQQIIIIIIINNNNFFFFFFFFFFFFFFEEEEEEIIIIIIIIIIIUUFFFJPPPPPQBISSSBBBBBBBBBVVVVVVXXXXXXXXXXXLLLYGYYYYYTTTTTTT
TTTTTTTTRRRRRIUUUEEIEEEEEEYEFFFFFFQQQIIIIIIIINNNBFFFFFFFFFFFFFFFEEEEIIPPPIIIIIIYUUFFFFFFPPPBBBBBBBBBBBBBBBVVVVVVVXXXXXXXXXXXLLLYYYYYYYYTTTTT
TTTTTTTTRRIIIIIIIIIEEEEEEEYYFFFFFFFFFFIIIIIQQNBNBBFFFFFFFFFFFFFEEEEEEIIIIWIIIITYYYFFFFFFTTPPPPBBBBBBBBBBNNVVVVVVXXXXXXXXXXXXLLLLYYYYYYYTTTTT
TTTTTTRRRRIIIIIIIIIIEEEEEEYFFFFFFFFFFFIIIIULQQBNBBBFFFFFFFFFNFOEEEEEIIIIIIIIITTYYYYFFFFTTTPPPBBBBBBBBBBBNNNVVVNNXXXXXXXXXXLLLLLLYYYYYYYYYTTT
TTTTTTTRRIIIIIIIIIITTEEEEFFFFFFFFFFFFFFIIILLLLBBBBBBBBFFFFFFOOOOOOCCIIIIIIIIIYYYYYYFFFTTTTPAABBBBBBBBBBBBNNNNNNNXXXXXXXXLLLLLLLLYYYYYYYYTTTT
TTTTTTTTRIIIIINIIIIITTTEEEEFFFFFFFFFFFFFFBBLLLLBBBBBBFFFFFFFXOOOOCCCCIIIIIIIIYYYYYYFFCCTTTCAABBBBBBBBBBBBNNNNNNNXXXXXXXXXLLLLLLYYYYYYYYYYTTT
TTTTTTRRRIIIIINIIIIITTTTEETFFFFFFFFFFFFJFBBLLBBEBBBBBBBFFFFFFCCOCCCCIIIIIIIIIYIYYYYFFRCTTTCAABBBBBBBBBBBBBBNBNNNXUXXXXXXLLLLLLLYYYYYYYYYTTTR
TTTTTTRRIIIIIINNNITTTTTTETTTTTFFFFFFFFFFFFLLLBBBBBBBBBBFFFFFICCOCCCCCCIIIIIIOYYYCYYCFCCCCCCAAABBBBBBBBOBBBBBBBNXXXXXXXMLLLLLLLLLLLLYYYYYYTTR
TTTTORRRRIBNNVNNNNNTTTTTTTTTTTFFFFFRRRRRRLLLLTBBBBBBBBFFFFCIICCCCCCCIIIIIIIIOOOYCCCCCCCCCCCCCCBBBBBBBOOOBBBBKBBBXXXXXXXXLLLLLLLLLLLSYSSSSTTT
TOOOORRRRBBBNNNNNNNNTTTTTTTTTTFFFFRRRRRRGLLLLBBBBBBBBBFFFFIIIIIIICCIIIIIIIIIOOOOOCCCCCCCCCCCCCCBBBBBBBBBBBBBBBBBXXXXXXXXLLLLLLLLLLSSSSSSSSTT
TOOOORRRBBBBNNNNNTNPTTTTTTTTTFFFFFRRRRRRRGLURFVVBVBBBBIIIIIIIIIIICCIIIIIIOIOOOOOCCCCCCCCCCCCCCCBBBBBXXXBBBBBBBBBBBXXXXXXLLLLLLLLSSSSSSSSSSST
OOOORRRRRBBBNNNNNNNPNTTTTTTTTTTFRRRRRRRRRRNRRFVVVVXBBIIIIIIIICCICCCCCCCIIOOOOOOOOCCCCCCCCCCCCCXXBBBBXXXBBBBBBBBBBBXXXXXXLLLLLLLLSSSSSSSSSSSS
OOOOLLLLRRRBNNNNNNNNNNNTTTATFFFFRRRRRRRRRRRRRFFVVVBBBIIIIIIIICCCCCCCCCCCAOOOOOOOOCCCCCCCCCCCCCXXXBBBXXBBBBBBBBBBBBBYYLLLLLLLRCSSSSSSSSSSSSSS
OOOOOLLLNSNBNNNNNNNNNJAJAAAFFFFFFRRRRRRRRRRRRRFVVVFBFFIIIIIIIICCCCCCCCCAAOOOOOOOOOOCCCCCCCCCCCXXXXXXXXXBBBBBBBBBBBBYYRLLLLLLRCCCSSSSSSSSSSSS
OOOOOLLINNNNNNNNNNNNEAAAAAAAFFFFRRRRRRRRRRRRRRFVVVFFFFFFIIIICCCCCCCCCCCAAAAOOOOOOOOCCCCCCCKCXXXXXNXBXBBBBBBBBBBBBBRRRRRRRRRORCCCCSSSSSSSSSSS
IOOOILIINNNNNNNNNNNNAAAAAAAAAAFFRCRRCRRRRRRRRRFFFFFFFFFHHIIIIICCCCCCCCCAAAAAAOOAOOOCCCCHHHXXXXXXNNXBBBBBBBBBBBBBBBRRRRRRRRRRRRRCCSSSSSSSSSSS
IIIIIIIIWWNNNNNNNNNNGGGAAAAAAAAAACRRCCRRRRRCCCCCFFFFFFFHHIPIAFCCCCCCCCCAAAAAOOOAOOCCZZHHHHHHXXXXXXXGBBBBBBBBBBBBJRRRRRRRRRRRRRCRSSSSSSSSSSSS
IIIIIIIIWWNNNNNNNNNNNGGAAAAAAAAAGRRCCCRRRRRCCCCFFFFFFFFHHHFFFFCCFCCCCCAAAAAAAAAAAOCZZZHHHHHHHXXXXXXGGBBBBBBBBBBJJRRRRRRRRRRRRRRRRSSSSLSSSSSS
IIIIIIEIWWNNNNNNNNNNGGAAAAAAAAGGGGCCCCCRRCCCCCCFCFFFFHHHFHFFFFFFFFCCCCAAAAAAAAAAZZZZZHHHHHHHHHHHHHXGHNHHBHHBBBBJRRRRRRRRRRRRRRRLRWSSSLLSSSSS
SIIIIIELWWNNWNNNNNNMNGGAAAAAAAAGCCCCCRRRRRCCCCCCCFYFFFHHFFFFFFFFFFCCCCAPAAAAAAZZZZZZZHHHHHHEEHEEHHHHHHHHHHHHHHHJRRRRRRRRRRRRRRRRYSSSSSLSSEES
IIIIILLLWWWWWNNNNNNNNGGAAAAAAAACCCCCRRRRRRRCCCCCCCCZFHHFFFFFFFFFFPCCCPPPAAAAAAGZZZZZZZZHEHHEEEEEHHHHEHHHHHHHHHHJJRRRRRRRRRRRRRRRRSSSSSSSGEES
IIIILLLLWWWWWPPKNNNVPGGAAAAAAGGRCCCCCRRRRRRCCCCCCCCCCPFFFFFFFFFFPPPPCPPUAAAAAAZZZZZZZZZHEEHEEEEEEEEEEHHHHHHHHHHJJJURRRRRRRRRRRRRESSSSSSSGGES
IIIIILLLLLWWWWPPPQQPPGGGGGAAAGGGGGGGGRRGQQRICCCCCCCCPPFFFFFFFFFFPPPPCPPUAAAADZNNZZZZZZZZEEEEEEEEEEEEYHHHHPPPPPPPPPPPURRRRRRRRRRNESSSSSSSSSSS
IIILLLLLPLWWWPPPPPPPPPGGGGGAAGGGGGGGGGGGGGGGCCCCCCCCPPFFFFFFFFFPPPPPPPPPDADDDZZZZZZRZZZZZEEEEEEEEEEEHHHHHPPPPPPPPPPPURRNRRRNRRNNESSSSSSSSSSS
IIIILLLLLLLWWPPPPPPPPGGGGGGGGGGGGGGGGGGGGCCCCCCCCCCCPPFFFFFFFFFPPPPPPPPPDDDDDDDZZZZRRZZZZEEEEEEEEEWWHHHHHPPPPPPPPPPPQURNNRRNNNNNNSSSSSSSSSSS
IILLLLLLLLLPPPPPPPPPPPGGGGGGGGGGGGGGGGGGGCCCCCCCCPPCPFFFFEFFFFFPPPPPPPPPPDDDDDDDZZZRRZZEEEEEEEEEEEWEHHHPPPPPPPPPPPPPUUUNNNNNNNNNNNHHSSSSSSSS
JLLLLLLLLLPPPPPPPPPPPPGGGGGGGGAGGGGGGGCGGCCCCCCCCPPPPFFFXXXFFFFPPPPPPPPPPDDDDDDDDRRRRRZEEEEEEEEEEEEEEHHPPPPPPPPPPPPPUUUNNNNNNNNNNNNHSSSSSSSS
JLLLLLLLLLLPPPPPPPPPPPPPGGGGGAAALLGGGGCCCCCCCCCCCCCPPFPFXXXXFFFFFPPPPPPPPPPPDDDRRRRRRRZZZZEEEEEEEEEIIHHPPPPPPPPPPPPUUUPNNNNNNNNNNNNHSSSSSSSS
JLHLLLLLLLPPPPPPPPPPPPPGGGGGGLLLLGGGGGICCCCCCCCCCCCPPPPFXXXXXFFFFPPPPPPPPPPDDDDRRRRRRRRZZEEEEEEEEEEIHHHPPPPPPPPPPPPUUWNNNNNNNNNNNKISSSSSSSSS
JLHLLLLLLLPPPPPPPPPPPPGGGGGGGLLLLLLGGGGCCCCCCCCCCPPPPPPPXXXXXXFFFFPHJJJPPPPDDDRRRRRRRRRZZZEEEEEEEEIIHDDDDDPPPPPPPPPUUUNNNNNNNNNNKKSSSSSSSSSS
JJLLLJLLTTTPPPPPPPPPPPGGGGGGGLLLLLLGGGGGKCCCCCCCPPPPPPXXXXXXXFFFFJJJJJJJPDDDDDDDRRRRRZZZZZZZEEEEEEIIHDDDDDPPPPPPPPPUUQNNNNNNNNNNNKKSSKSSSSSS
JJJJJJJJJJJPPPPPPPPPPPGGGGGGGLLLLLLGGGGGGCCCCCCCCCPPPPXXXXXJJJFJJJJJJJJJJJJDDDDDRRRZZZZZZZZZZEEEIIIIHHDZZDDDDUUUUUUUUUENNNNNNNNKKKKKKKKSSSSS
JJJJJJJJJJJMPPPPPPJPGGGGGGGQGQLLLBLGGGCCCCCCCCCCCCCPPPPXXXXJJJJJJJJJJJJJJJJJDDDDDRRZZKKKKZZQQQQQIQIIZZZZZDDDDUUUUUUUUUUUNNNNNMVKKKKKKKKSKSKS
JJJJJJJJJMMMMPMMPMPPMMGGGGGGGLLLLLLLLLLCCCCCCCCCCCPPPPPPXXXXJJJJJJJJJJJJJJJDDDDDDRZZKKKKKZZKQQQQQQQIIZZZDDDUUUUUUUUUUUUVVVVNNVVVKKFFFKKKKKKK
JJBBJJJJJMMMMMMMMMPPMMMMGWWWGLLLLLLLLLPCCCCCCCCCCPPPPPPPYYYYYYYJJJJJJJJJJJJDFDFFFNKKKKKKKKKKKQQQQQZZZZZZZZDZZZDUUUUUUUUVVVVVVVVVIFFFKKKKKKKK
JBBBJJJJJJMMMMMMMMMPMMMGGGLLLLLLLLLLLLLLCCCCCCCCCCCPPPYYYYYYYYJJJJJJJJJJJJJFFFFYFFXFFKKKKKKKKKQQQQQZZZZZZZZZZZZUUUUUUUUVVVVVVVVIIFFFKKKKKKKK
JBBBBBBMMMMMMDMMDMMMMMMMMMLLLLLLLLLLLLLLCCCCCCCCCCCPPYYYZYYYYYYJYJJJJJJJJJJJFXFFFFFFFKKKKKKKKKQQQQQQZZZZZZZZZJZSUUSUUTUVVVVVSVVVIIFFFFKKKKKK
JBBBBBBMMMDDDDDDDMMMMMMMMGGSSSLGLLLLLLKCCCCCCCCCCCCPPPYYZYYYYYYYYJJJJJJJJJFFFFFFFFFFFKKKKKKKKKQQQQQQQZZZZZZZZQQSSSSSSUUUVVVVVVVVVIVXFFFKKKKK
BBBBBBBBMMDDDDDDDDDDMMGGGGGGGGGGGGGLKLLCCCCCCCCCCCCCCUYYYYYYYYYYYYJJJJJJJJMFFFFFFFFFFKKKKKKKKKQQQQQQQZZZZZZZZQQQQSSSSUUVVVVVVVVVIIVVKKKKKKKK
BBBBBBBMMMMDDDDDDDDDMMMGGGGGGGGGGGGKKKKKCUCPUCCCCCCUUUUUYYYYYYYYJJJJJJJJJFFFFFFFFFFFFKKKKKKKKQQMQQQQQZZZZZZZZZQQQSSSSSVVVVVVVVVVVVVVKKKKKKKK
BBBBBBBMMMDDDDDDDDDDMMGGGGGGGGGGGGKKKKKKKUUPUCCCCCUUUUYYYYYYYYYYYYJJJJJJJFMFFFFFFFFFFKKKKKKKQQQMQMQQQQQZZZQQZQQQQSSSSSSVVVVVVVVVCVVVKKKKKKKK
BBBBBBMMMMDDDDDDDDDMMMGGGGGGGGGGGGGGKKKKKKUUUCCCCCUUUUYYYYYYYMYYYYYYJWWWWFFFFFFFFFFFFKKKKKKMMMMMMMMQQQQZQQQQQQQQSSSSSSSSVVVVVVVVVKKKKKKKKKKK
BBBBBBBBMPVDDDDDDDDWWWGGGGGGGGGGGGGGKKKKUUUCCCCCCUUUUUUYYMMMMMMYYYMMWWMWWFFFFFFFFFFFFKKKKMMMMMMMMMMMQQQQQQQQQQQQQQQSSSSSSSVVVVVVOOOKKKKKKKKK
BBBBBBBPPPVDDDDDDDDWWWGGGGGGGGGGVGGGKKUUUUUUCCCCUUUUUUUUMMMMMMMMMYMMMMMMWWFFWFFFFFFFFKKKKMMMMMMMMMMMQQQQQQQQQQQQQQQSSSVVVVVVVVOOOOOOOKKKKKKK
BBBBBRBPPPPPPDDDDDDDWWGGGGGGGGGGTTTTTTTUUUUUUUCUUUUUUUUUMMMMMMMMMMMMMMMMMWWWWWFFFFFZFKKKKMMMMMMMMMWWQQQQQQQQQQHHQQQSSSSTTTTTOOOOOOOONNOOKKKK
BBBBBBBPPPPPPDPPDDDWWWGGGGTTTTTTTTTTTTTUUUUUUUCUUUUUUUUUMNMMMMMMMMMMMMMMWWWWWWFFFFFFFKKMMMMMMMMMMMWWQQQQQQQHHHHHHQQSSSTTTTTTOOOOOOOOONOOOOKK
QBBBRPPPPPPPPPPPDDDWWWGGGGTTTTTTTTTTTTTIUUUUUUUUUUUUUUUMMMMMMMMMMMMMMMMMUWWWWWWFFFWKKKKKKYMMMMMMMMWWQQQQHHHHHHHHHQQQASTTTTTJOOOOOOOOOOOOOOOK
QBBBBPPPPPPPPPPPPPDWWWGWGGTTTTTTTTTTTTTIIUIIUUUUUUUUUMMMMMMMMMMMMMMMMMMUUWWWWWWWWKKKKKKKKKKMMMMMMMMMMMMHHHHHHHHHHQQQASTTTPPOOOOOOOOOOOOOOOOO
QQQQBPPPPPPPPPPWPWWWWWWWWWGGGGTTTTTTTTTIIIIIUUUUUVUUUUMMMMMMMMMKMMMMMMMXUUUUUUUUWWWKKKKKKKKMMZMMMMMMMMMXHHHHHHHHHHQTTTTTXOOOOXXOOLOOOOOOOOOO
QQPPPPPPPPPPPPPWWWTTTTTTTTWTTTTTTTTTTTTIIIIIUUUPPPPPUUUMMCMMMMRKMMMMMMMXUUUUUUUWWWKKKKKKKKMMMMMMMMMMRHHXHHHHHHHHHHHHTTTTTXXOXXXTOLOOOOOOOOOO
PPPPPPPPPPPPWWWWWWTTTTTTTTWTTTTTTTTTTTTIIIIIIIUPPPPPUUUVVVMMMMMKKNMMXXXXXUUUUUUUWWUKKKKKKKVMMMMMMMMMHHHHHHHHHHHHHHHTTTTTTXXOXXTTTTTOOOOOOOOT
HHPPPPPPPPPPWWWWWWTTTTTTTTWTTTTTTTTTTTTIIIIPIIUPPPPPVVVVVVLMMKKEKKKXXXXXUUUUUUUUUUUVKKKKVVVVVVMEEEEEEHHHHHHHHHHHHHHTTXXXXXXOXXTTTTOTOOOOOOOT
HHHPPPPPPPPPWPWWWWTTTTTTTTTTTTTTTIIIIIIIIPPPPPPPPPPPVVVVVVVKKKKKKKKKKKXXXUUUUUUUUUUVKKKKKVVVVVZZZEVVVHHHHHHHHHHHHHHHHXXXXXBVTTTTTTOOOOOOOOOT
HHHPPPPPPPPPPPWWWWTTTTTTTTTTTTTTTIIIIIIIIPPPPPPPPPPPVVVVVVVKKKKKKKKKKKXXXIIUUUUUUUVVVKKVVVVVVVZZZZVVVHHHHHHHHHHHHHXXXXXXBBBBCTTTTTTOOOOOOOTT
HHHPPPNNNPPPPPWPWWTTTTTTTTTTTTTTTIIIIIIIIPPPPPPPPPPPVVVVVVKKKKKKKKKKKKKXIIIJJJIDUUVVVKVVVIVVZZZZZVVVVVIHHHHHHHHHHHXXXXXXBBBBBTTTTTCCOOOOOTTT
HHHHPNNNNNJPPPPPWWWWTTTTTTTTTTTTTIIIINIIIPPPPPPPPVVVVVVVVVVKKKKKKKKKKKKKIIIIIIIIIIVVVVVVVIIVVVVVVVVVVVIHOOHHHHHHXXXXXXXXXXBBBTTTTTOCOOOOOTTT
HHHHNNNNNNJJJJPPWWWWTTTTTTTTTTTTTIIITNIIIIIEEEEEVVVVVVVVVVVVVKKKKKKKKKKKIIIIIIIIIIVVVVVVIIIVVVVVVVVVVVVHPOOOHIIIIIIXXXXXXBBBBTTTTOOOOOOTTTTT
HHNNNNNNNXJJPPPPPWWWTTTTTTTTWWWIIIIITTTIIIIEEVVVVVVVVVVVVVVKKKKKKKKKKMKKIWIIIIIIIIVVVVVIIIVVVVVVVVVVVVVHPPOIIIIIIIIXXBXXXBBBBTTTTTTTOTTTTTTT
HHHHNNNNNJJJPEEPPWWWTTTTTTTTWWWWUUTITTTTIEEEEVVVVHVVVVVVVVVVKKKKKKKKKTTTIITIIIIEEEEVVEEIIIIVVVVVVVJVVVVPPIIIIIIIIIBBXBBBBBBBBTTTTTTTOTTTTTTT
HHHHNNNNNPPPPEEEPPEWTTTTTTTTUWWWUUTTTTTIIIEEEVCVVHVVVVJJVVAXXKKKKKKKKTTTITTTTEEEEEEEEEEIIIIVVJVVJJJVVVPPPPIIIIIIIBBBBBBBBBBTTTTTTTTTOTTTTTTT
HHHHNNNNNPPPPPEEEEEMWEEWEEEUUWUWUUTTTTTTEEEEEVCCVHVVVJJJJAAXXKKKKKKJJTTTTTTTTTEEEEEEEEEIIIIVJJVJJJJJVPPPPPPIIIIIIBBBBBBBBBBTTTIIIITTCCTTTTTT
LLLLLNNNNNNPEEEEEEEEEEEEEEUUUUUUUUTTTTTTETEEEEJCCJJJJJJJJJJXXXXXKKKKXXXTEEETTTEEEEEEEEEIIIIIJJJJJJJJJPPPPPIIIIIIIIBBBBBBBBTTTTIIIITTTCCCCCTT
LLLLLLLLLLLLEEEEEEEEEEEEEEUUUUUUUTTTTTTTTTEEEEJJCJJJJJJJJJJJJXXXXXXXXXXTEEEDTEEEEEEEEEEEIIIKKJJJJJJJJJPPNNNIIIIIIBBBBBBBBIIIIIIITTTTCCCCCTTT
LLLLLLLLLLLDDDEEEEEEEEEEUUUUUUUUTTTTTTTTTEEEEEJJJJJJJJJJJJJJJXXXXXXXXXXXEEEEXXEEEEEEPPPPPPIJJJJJJJJJPPPPPPNNIIIIBBBBBBBBIIIIIIIITTTCCCCCCCCT
LLLLLLLLLPPDEEEEEEEEEEEEEEEUUUUUUUTYYYYTTEEEEEBBJJJJJJJJJJJJJJXXXXXXXXEEEEEEEEEEEEEEPPPPPPEEJJJJJPJPPPPPPPNNVIINNBBBBBBBBIIIIIITTTTTCCCCCCCT
LLLLLLLLLPPPEEEEEEEEEEEEEEEUUUUUUUJJYYYTEEEEEBBBBBJJJJJJJJJJJJXXXXCPPUEEEEEEEEEEEEEEPPPPPPEELJJAAPPPPPPPPPNNNNFNNNBBBBBBBBIIIITTTTTCCCCCCCCC
LLLLLLLLPPPPEEEEEEEEEEEYYEUUUJJJJJJJJJYEEEEBBBBBBBBJJJJJJJJJJJXXXXPPPPPPEEEEEEEEEEEEPPPPPPEELJJAAPPPPPPPPPNNNNNNNNNNBBBBBLLIIIITTTTCCCCCCCCC
LLLLLLLLPPPPPEEEEEEEEEEEYYUUUJJJJJJJJJYEEEEBEEBBBBBJCJJJJJJJJJXXMMMPPPPPFFEEFFEEEEEEPPPPPPEEEEAAAPPPPPPPPNNNNNXXNNWWBBZLLLLIJTTTTTTTCCCCCCCC
LLLLLLLLLZPPPPPPEEEUEEEYYYYYYJJJJJJJJJJEEEEBBBBBBBBBBBEJJJJJJJXXMMMPPPPPPFFFFFELEEEEPPPPPPAAAAAAAAAPPPPPMMNNNNNNNNWWWWLLLLLSSTTTTTTQQCCCCCCC
LLLLLLLLPPPPPPPPEEEEEEEYYYYYJJJJJJJJJJJXXEEVBBBBBBBBBBJJJJJJJIXXMMPPPPPPFFFFFCEEEPPPPPPPPPPPPPAAAAAPPPPPMMNNNNNNCSSWWCLLLLLRSTSTTTTCCCCCZCCC
LLLLLLLPPPPPPPPPPEPPPEYYYYYYYYJJJJJJJJJJJTEETBBBBBBBBBBJJJJJJJMMMMPPPPPPPFFFFCCCCPPPPPPPPPPPPPAAAAPPPAPMMMMNNNNNCSSCCCLJCCCCSSSTTSSSCCCCZZZZ
LLLLLLLPPPPPPPPPPPPPYYYYYYYYYYJJJJJJJJTJTIIIITBBBBBBBBBBJJJJJMMPPPPPPPPPPPFFFCCCCPPPPPPPPPPPPPAAAAPPAAAAMMMNNNNSSSSSCCCCCCCCCSSSSSSSDCBBZZZZ
LLLLLLLLPPPPPPPPPPPPYYYYYYYYYYYJJJJJJJTOOIIIITTBBBBBBBBBJJJJJMMPPPPPPPPPPFFFFFCCCPPPPPPPPPPPPPAAAPPPAAAMMMMMNNNSSSSCCCCCCCCCCSSSSSSKDDDBBBZZ
LLLLLLLPPPPPPPPPPPPYYYYYYYYYYYYJJJJJTTTTTIIIITBBBABBBBBBBJOJJJMPPPPPPPPPPFFFFFCCCPPPPPPPPPPPPPAAPPPPAAAAMMMMMMMMMSMCCCCCCCCCCSSSSSDDDDDBZZZZ
LLLQLLLLSPPPPPPPPPPYYYYYYYYYYYYYYJRRTTTTTIIIITBBBABBBBBMMJJJJJJJPPPPPPMPPFFFFFCCCFRRRRAPPPPPPPAPPPPAAAAAMMMMMMMMMMMCCCCCCCCCCCSSSSXXXDDDZXZZ
LLLQQLLLSPPPPPPPPPPYYYYYYYYYYYYRRRRTTTTTTIIIITTBBBBBMBBMMMMJJJJJMPPPMPMMPFFFFFCCFFRRRAAAAAAAAAAPPPPPAAOZZMMMMMMMMMMMCCCCCCCCCUSSSSXXXXDDXXXZ
LLQQQQWLPPPPPPPPPPPYYYYYYYYYYYYYRRRTTTTIIIIIITTTBBBMMMMMZMMMJJJJMPMMMPMMMFMMFFFFFFFFFQQQAAAAAAAPPPPPPOOZZZMMPPPPPPPPPPCCCCCCCCISSRXXXXXXXXXX
LLQQQQQQDDDPPPPPPPPBBYYYBBYYYYRRRRRRTTTIIIIIITTTMMBMMMMZZMZZJJJJMMMMMMMMMMMMFMMFFFFFFFQQQQAAALLPPDDDOOOZZZZMPPPPPPPPPPJJCCCCCCCRRRRXRXXXXXEE
LLQQQQQQDDPPPPBPPBBBBBBBBBYBYRRRRRRRRTTIIIIIITTMMMMMMMMZZZZZJJJJMMMMMMMMMMMMMMMMFFFFQQQQQRAAAPPPPGDOOOOZZZMMPPPPPPPPPPPPPPPPCCRRRRRXRRXXEEEU
LQQQQQQQDDDBBBBBBBBBBBBBBBBBBRRRRRRRRTTIIIIIITTMMMMMMMMZZZZZJJJJMMMMMMMMMMMMMMMMFTFTRQQQQRFAGGGGGGDDDZZZZZMMPPPPPPPPPPPPPPPPCRRRRRRRRRXXEEEE
QQQQQQRQDQQBBBBBBBUBBBBBBBBBBBRRRRQQQIIIIIIIITTFFMMMMMMZZZZZJJJJZMMMMMMMMMMMMMMTTTTTRRQQRRFAAGGGGGDEDSZZZZEMPPPPPPPPPPPPPPPPJRRRRRRRRRXEEEEE
QQQQQQQQQQJBBBBBBBUBBBBBBBBBBBBRRRQQQIIIIIIITTTFFFMMMMZZZZZZZZZMMMMMMMMMMMMMMMTTEETTTRQRRRRGGGGGGDDDDSZZZZMMPPPPPPPPPPPPPPPPJRRRRRRRRREEEEEE
QQQQQQQQQQJJBBBBBUUUBBBBBBBBBBOORQQQQIIIIIIITTTTIFFFFMZZZZZZZZJZMMMMMMMMMMMMAAEEEEEETRRRRRRRGGGGGGDDSSZZZZMMPPPPPPPPPPPPPPPPPRRRRRRRREEEEEEE
QQQQQQQQQQJJBBSBUUUZBBBBBBBCBOOORQQQQIIIIIIIITTTFFFFFFVZZZZZZZZZMMMTMMTTMMTMAEEEEEEERRRRRRRRRGGGGGDDUZZZZZMMPPPPPPPPPPPPPPPPPRSRRRRRREEEEEEE
QQQQQDQQWDJJJJUUUUUZZZBBBOCCCOOOOQQQQIIIIIIIITTFFFFFFFFZZZZZZZZZMMMTMMTTTMTMMMEEEEEEEEIIRRRRRGGGGGUUUZZZZZOMPPPPPPPPPPPPPPPPPSSRRRRZLLTLLEEE
QQQQQDDDDDDDJJJJJUUUUBBBBOCCCOOOOQQQQIIIIIIIIEFFFFFFFZFYZZZZZZZZMTTTTTTTTTTTMLLEEEEEEEIIRRRRRRGGGGUUUXZZZOOOPPPPPPPPPPPPPPPPPSBBBRRRALLLLLEE
QQQQQDDDDDDDDDJUUUUUUSBBBOOOOOOOOQQQQIIIIIIIIEFFFFFFFZZZZZZZZZZZTTTTTTTTTTTTTTLTTEEEEERRRRXRRPPPPGGUXXXVOOOOOOOOOOEEEPPPPPPPPBBBBBBAAAALLLLL
QQQQQQDDDDDDDDJJUUZUUUSSSOOOOOOOOQQQQIIIIIIIIEFFFFFLLZZZZZZZZZZTTTTTTTTTTTTTTTTTTEEEEEREEEEORPPPPGUUXXXVOOOOOOOOOOEEEPPPEBBBBBBBBBBAAAAALLLL
QQQQQDDDDDDDDDDUUUUASSSOOOOOOOOOOOQQQIIIIIIIIEEFFFFLLZZZZZZZZZZTTTTTTTTTTTTTTTTTTTETEEEEEEEPPPPPPGUUXXXVVOOOOOOOOOOEEPPPEBBBBBBBBBAABABBBLLL
QQQQQHDDDDDDDDDAUUUAASSAGGGOOOOOOOQQQGGQGGGGGEFFFFLLLLLZZZZZZTTTTTTTTTTTTTTTTTTTOTTTEEEEEEEAPPPPPPPXXXVVVVVVOOOOOOEEEEEEEBBBBBBBBBBBBBBBLLLL
QQQDDDDDDDDDDDDAUAAAAAAAAGOOZOOOOOQGGGGGGGGGGGBBBBLLLLLZZZZZZTMTTTTTTTTFTTTTVVEEOTEEEEEEEEEEPPPPXXXXXXVVVVVOOOOOOOEEEEEEEABBBBBBBBBBBBBBLLLL
QRDDDDDDDDDDDDAAAAAAASSAGGZZZZOOOOGGGGGGGGGGGGGBLLLLLLLZZZZZZZTTZTTTTTTFFFFTTVVEEEEEEEEEETEEPPSSVVVXXXVVVVVOVOOOOOEEEEEEEBBBBBBBBBBBBBBLLLLL
RRDNDDDBDDDDDDAAAAAAASSGGZZZZZOOOOGGGGGGGGGGGGGGSLLLLLZZZZZZZZZZZTZTTTTTFFFTVVVVEEEEEEEEEEEEXXXXSVVVXXVVVVVVVOOOOEEEWEEWWBBWBBBBBBBBBBPLPLLL
RRDDDDDBDDDDDDAAAAAAASSSSZZZZZOTGGGGGGGGGGGGGGGSSSLLLLLZZZZZZZZZZZZTTTTFFFFVVVVVEEEEEEEEEEEEXXXXSVVVVVVVVVVVVVVZZZWWWWEEWWWWWBBBBBBBBPPPPLLL
RRDDDDDDDDDDDDAAAAAAASSSSSZZZZOGGGGGGGGGGGGGGGGSSSLLLLZZZZZZZZZZZZZTTTTTFFFVVVVVVEEVVEEEEEEXXXXXXVVVVVVVVVVVVZZZZZWWWWWWWWWBBBBBBBBBBLLPPLLL
RRDDDDDDDDDDDDDAAAAASSSSLSYZZYGGGGGGGGGGGGGGGSSSSSSSLLZZZZZZZZZZZZZZTTTTFVVVVVVVVEEVVEEEEXXXXXXXXVVVVVVVVVVVVZZZZZZZWWWWWWBBBBBBBVBBLLLPPLLL
RRRDDDDDDDDDKKKKAAAAGGSLLLZZZZNGGGGGGGGGGGGGGSSSSSSSSLZZZZZZZZZZZZZTTTTTVVVVVVVVVVVVVEUXXXXXXXXXVVVVVVVVVVVVVZZZZZZZZWWWWWWBBQBBBVBBLLLLLLLL
"""


def to_image(text: str) -> np.ndarray[int]:
    return np.array([[ord(c) for c in word] for word in text.strip().split('\n')])


def perimeter(mask: np.ndarray[bool]) -> int:
    n_interior = abs(np.diff(mask, axis=0)).sum() + abs(np.diff(mask, axis=1)).sum()
    n_boundary = mask[0, :].sum() + mask[:, 0].sum() + mask[-1, :].sum() + mask[:, -1].sum()
    return n_interior + n_boundary


def find_corners(mask: np.ndarray[bool]) -> list[tuple[float, float]]:
    i,j = np.nonzero(mask)

    ops = [
        (-0.5, -0.5),
        (-0.5, +0.5),
        (+0.5, -0.5),
        (+0.5, +0.5),
    ]
    coords = [(ii + op[0], jj + op[1]) for ii, jj in zip(i, j) for op in ops]
    num_adjacent_pixels = Counter(coords)
    corner_coords = [k for k, v in num_adjacent_pixels.items() if v % 2 == 1]
    # look for the stupid
    # A B
    # B A
    # case...
    stupid_maybe_corners = [k for k,v in num_adjacent_pixels.items() if v == 2]
    for coords in stupid_maybe_corners:
        i,j = coords
        if i < 0.5 or j < 0.5 or i > mask.shape[0] - 1.5 or j > mask.shape[1] - 1.5:
            continue
        n = int(i - 0.5)
        s = int(i + 0.5)
        w = int(j - 0.5)
        e = int(j + 0.5)
        if (
                (mask[n, w] and mask[s, e])
            or
                (mask[n, e] and mask[s, w])
        ):
            corner_coords += [coords, coords]

    return corner_coords


def cost(image: np.ndarray[int], verbose: bool = False) -> tuple[float, float]:
    labelled = skimage.measure.label(image, connectivity=1)
    print(f"{len(np.unique(labelled))} plots")
    cost_p1 = 0
    cost_p2 = 0
    for l in np.unique(labelled):
        mask = labelled == l
        area = mask.sum()
        perim = perimeter(mask)
        nsides = len(find_corners(mask))

        if verbose:
            print(f"{chr(image[mask][0])}: area {area}, perim {perim}, #sides {nsides}")

        cost_p1 += area * perim
        cost_p2 += area * nsides
    return(cost_p1, cost_p2)

print(cost(to_image(ex1)))
print(cost(to_image(ex2)))
print(cost(to_image(ex3)))
print(cost(to_image(ex4)))
print(cost(to_image(ex5), verbose=True))
print(cost(to_image(input)))
